{% extends 'base.html' %}
{% block content %}
  <div class="max-w-6xl mx-auto py-12">
    <h1 class="text-2xl font-bold mb-6">Admin Dashboard</h1>

    <!-- Messages -->
    {% if messages %}
      <div class="mb-4">
        {% for message in messages %}
          <div class="p-3 rounded-lg 
          {% if message.tags == 'success' %}
              
            bg-green-100 text-green-800

            {% elif message.tags == 'error' %}
              
            bg-red-100 text-red-800

            {% else %}
              
            bg-gray-100 text-gray-800

            {% endif %}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}

    <!-- Rooms Management -->
    <h2 class="text-xl font-semibold mb-4">Manage Rooms</h2>
    <table class="w-full border-collapse border border-gray-300 mb-8">
      <thead>
        <tr class="bg-gray-100">
          <th class="border px-4 py-2">Room</th>
          <th class="border px-4 py-2">Capacity</th>
          <th class="border px-4 py-2">Status</th>
          <th class="border px-4 py-2">Action</th>
        </tr>
      </thead>
      <tbody>
        {% for room in rooms %}
          <tr>
            <td class="border px-4 py-2">{{ room.name }} ({{ room.number }})</td>
            <td class="border px-4 py-2">{{ room.capacity }}</td>
            <td class="border px-4 py-2">
              {% if room.is_open %}
                <span class="text-green-600 font-semibold">Open</span>
              {% else %}
                <span class="text-red-600 font-semibold">Closed</span>
              {% endif %}
            </td>
            <td class="border px-4 py-2">
              <form method="post">
                {% csrf_token %}
                <input type="hidden" name="room_id" value="{{ room.id }}" />
                <button type="submit"
                  name="toggle_room"
                  class="px-3 py-1 rounded-lg 
                {% if room.is_open %}
                     bg-red-700 hover:bg-red-800
                  {% else %}
                     bg-green-700 hover:bg-green-800
                  {% endif %} text-white">
                  {% if room.is_open %}
                     Close
                  {% else %}
                    Open
                  {% endif %}
                </button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Bookings Overview -->
    <h2 class="text-xl font-semibold mb-4">All Bookings</h2>
    {% if bookings %}
      <ul class="space-y-3">
        {% for booking in bookings %}
          <li class="bg-white shadow rounded-lg p-4 flex justify-between items-center">
            <div>
              <p>
                <strong>{{ booking.user.username }}</strong> booked <strong>{{ booking.room.name }}</strong>
              </p>
              <p class="text-gray-600">{{ booking.start_time|date:'Y-m-d H:i' }} â€“ {{ booking.end_time|date:'H:i' }}</p>
            </div>
            <form method="post" onsubmit="return confirm('Are you sure you want to delete this booking?');">
              {% csrf_token %}
              <input type="hidden" name="booking_id" value="{{ booking.id }}" />
              <button type="submit" name="delete_booking" class="px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded-lg">Delete</button>
            </form>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-gray-600">No bookings yet.</p>
    {% endif %}
  </div>
{% endblock %}
